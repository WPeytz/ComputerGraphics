<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title> Worksheet 6: Texture mapping - Part 3</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    #my-canvas {
      width: 1024px;
      height: 512px;
      display: block;
      margin: 20px auto;
      border: 1px solid #ccc;
      background: #000;
    }
    .explanation {
      max-width: 1024px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .explanation h2 {
      color: #2196F3;
      margin-top: 0;
      border-bottom: 2px solid #2196F3;
      padding-bottom: 10px;
    }
    .explanation h3 {
      color: #555;
      margin-top: 20px;
    }
    .explanation p {
      line-height: 1.6;
      color: #666;
      margin: 10px 0;
    }
    .explanation ul {
      line-height: 1.8;
      color: #666;
    }
    .explanation strong {
      color: #333;
    }
    .highlight {
      background: #e3f2fd;
      padding: 15px;
      border-left: 4px solid #2196F3;
      margin: 15px 0;
      border-radius: 4px;
    }
    .comparison {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin: 20px 0;
    }
    .comparison div {
      padding: 15px;
      background: #f9f9f9;
      border-radius: 4px;
      border: 1px solid #ddd;
    }
    .comparison h4 {
      margin-top: 0;
      color: #333;
    }
    .good {
      border-left: 4px solid #4CAF50;
    }
    .bad {
      border-left: 4px solid #f44336;
    }
  </style>
</head>
<body>
  <h1>Worksheet 6 — Part 3: Earth Texture Mapping</h1>
  <canvas id="my-canvas"></canvas>

  <div class="explanation">
    <h2>Texture Filtering Choice for High-Resolution Earth Texture</h2>

    <div class="highlight">
      <strong>Selected Filtering Mode: LINEAR_MIPMAP_LINEAR (Trilinear Filtering)</strong>
      <p>This filtering mode provides the best balance between image quality and performance for high-resolution textures during rotation and minification.</p>
    </div>

    <h3>The Problem</h3>
    <p>The Earth texture is high-resolution, which causes severe <strong>minification issues</strong> when viewing the globe, especially during rotation. Mountain ranges, coastlines, and other fine details can appear to shimmer, flicker, or create moiré patterns because multiple texture pixels (texels) are being mapped to a single screen pixel.</p>

    <h3>How LINEAR_MIPMAP_LINEAR Solves It</h3>
    <p>Trilinear filtering works in three stages:</p>
    <ul>
      <li><strong>Mipmaps:</strong> Pre-filtered versions of the texture at progressively lower resolutions (e.g., 2048×1024 → 1024×512 → 512×256 → ... → 1×1). The GPU automatically selects the appropriate mipmap level based on how much the texture is being minified in screen space.</li>

      <li><strong>Linear filtering within each mipmap level:</strong> Instead of picking the nearest texel (which creates blocky artifacts), the GPU samples 4 neighboring texels and bilinearly interpolates between them, creating smooth gradients.</li>

      <li><strong>Linear interpolation between mipmap levels:</strong> To prevent visible "popping" when transitioning between mipmap levels, the GPU blends between two adjacent levels, creating seamless transitions.</li>
    </ul>

    <h3>Why This Choice?</h3>
    <div class="comparison">
      <div class="good">
        <h4>✓ With LINEAR_MIPMAP_LINEAR</h4>
        <ul>
          <li>Sharp detail up close</li>
          <li>Smooth rendering at distance</li>
          <li>No aliasing or flickering</li>
          <li>Mountain ranges remain clear</li>
          <li>Minimal blur</li>
        </ul>
      </div>
      <div class="bad">
        <h4>✗ Without Mipmaps (LINEAR/NEAREST)</h4>
        <ul>
          <li>Severe aliasing and shimmering</li>
          <li>Flickering during rotation</li>
          <li>Moiré patterns</li>
          <li>Loss of fine detail</li>
          <li>Visually distracting</li>
        </ul>
      </div>
    </div>

    <h3>Alternative Options Considered</h3>
    <ul>
      <li><strong>NEAREST:</strong> Extremely blocky and pixelated. Severe aliasing during minification.</li>
      <li><strong>LINEAR:</strong> Smooth but still suffers from severe aliasing when minified. No pre-filtering.</li>
      <li><strong>NEAREST_MIPMAP_NEAREST:</strong> Uses mipmaps but picks single texels. Blocky appearance and visible transitions between mipmap levels.</li>
      <li><strong>LINEAR_MIPMAP_NEAREST:</strong> Smooth within each level but visible "popping" when switching between mipmap levels.</li>
      <li><strong>Anisotropic filtering:</strong> Would be even better for oblique viewing angles but requires WebGL extensions and more GPU power.</li>
    </ul>

    <h3>Trade-off</h3>
    <p>LINEAR_MIPMAP_LINEAR introduces a <strong>slight blur</strong> compared to using no filtering, but this minimal blur is <strong>far preferable</strong> to the severe flickering, shimmering, and aliasing artifacts that occur without mipmaps. The Earth maintains sharp, clear details while rotating smoothly without visual artifacts.</p>

    <h3>Technical Implementation</h3>
    <p>The implementation uses:</p>
    <ul>
      <li><code>gl.generateMipmap(gl.TEXTURE_2D)</code> to automatically generate all mipmap levels</li>
      <li><code>gl.TEXTURE_MIN_FILTER = gl.LINEAR_MIPMAP_LINEAR</code> for minification (when texture appears smaller than original)</li>
      <li><code>gl.TEXTURE_MAG_FILTER = gl.LINEAR</code> for magnification (when texture appears larger than original)</li>
    </ul>
  </div>

  <script src="w06p3.js"></script>
</body>
</html>